# _includes/ - Reusable Jekyll Partials

13 include files across 3 subdirectories. Unified Tailwind styling.

## STRUCTURE

```
_includes/
├── header.html             # Site header with nav + theme toggle (29 LOC)
├── sidebar.html            # Recent notes navigation - pure Tailwind (24 LOC)
├── footer.html             # Minimal footer text (2 LOC)
├── nav.html                # Alternate simple nav (4 LOC)
├── head.html               # Full <head> tag for standalone layouts
├── theme-toggle-button.html # Dark/light mode button (18 LOC)
├── link-previews.html      # Link preview popups
├── react_graph.html        # GraphView island markup (DEPRECATED - moved to canvas homepage)
├── notes_graph.json        # Generated by bidirectional_links_generator.rb
│
├── page_sidebar/           # Right sidebar widgets (Tailwind styling)
│   ├── media_widgets.html  # Audio/video widgets (103 LOC) ✓ Tailwind
│   └── references.html     # Source references (68 LOC) ✓ Tailwind
│
└── jcanvas/                # Canvas-specific includes
    ├── head.html           # Canvas page head
    ├── nav.html            # Canvas navigation
    └── 404.html            # Canvas 404 page
```

## USAGE MAP

| Include | Used By | Purpose |
|---------|---------|---------|
| `header.html` | base-shell | Site header, primary nav, theme toggle |
| `sidebar.html` | sidebar-layout | Left sidebar recent notes list (pure Tailwind) |
| `footer.html` | base-shell | Site footer content |
| `theme-toggle-button.html` | header, nav | Sun/moon toggle button |
| `page_sidebar/media_widgets.html` | sidebar-layout | Audio/video in sidebar |
| `page_sidebar/references.html` | sidebar-layout | Reference links sidebar |
| `head.html` | canvas, canvas-home | Full HTML head for standalone |
| `jcanvas/*` | docs | Canvas documentation system |

## CSS STYLING

All includes now use **Tailwind classes** consistently:

```html
<!-- Color classes used -->
text-foreground      /* Primary text */
text-foreground/75   /* Secondary text (opacity) */
text-muted           /* Muted/tertiary text */
text-accent          /* Accent/link color */
bg-surface           /* Card/panel backgrounds */
bg-background        /* Base background */
border-border        /* Standard borders */
border-accent        /* Active/highlighted borders */
```

## WHERE TO LOOK

| Task | File | Notes |
|------|------|-------|
| Change site header | `header.html` | Nav items from `site.data.navigation.primary` |
| Add nav items | `_data/navigation.yml` | Define primary nav links |
| Modify sidebar notes | `sidebar.html` | Shows recent 15 notes, pure Tailwind hover |
| Add audio widget | `page_sidebar/media_widgets.html` | Requires `page.audio_file` |
| Add video widget | `page_sidebar/media_widgets.html` | Requires `page.videos` array |
| Add references | `page_sidebar/references.html` | Requires `page.sources` array |
| TOC functionality | Use `<sidebar-toc>` web component | Include is deleted, use web component |

## CONVENTIONS

**Include with Parameters:**
```liquid
{% include page_sidebar/toc.html %}
```

**Conditional Includes in Layouts:**
```liquid
{% if page.right_sidebar contains 'toc' %}
  {% include page_sidebar/toc.html %}
{% endif %}
```

**Front-Matter Triggers:**
```yaml
# For media_widgets.html
audio_file: /assets/audio/guide.mp3
audio_timestamps:
  - time: "0:30"
    description: "Introduction"
videos:
  - title: "Tutorial"
    embed_id: "dQw4w9WgXcQ"
    platform: "youtube"

# For references.html
sources:
  - title: "Documentation"
    url: "https://example.com"
    type: "documentation"  # or: website, article, github
```

## ANTI-PATTERNS

- **NEVER** add new includes using legacy CSS variables (`--text-primary`, `--bg-secondary`, etc.)
- **NEVER** use inline JavaScript hover handlers - use Tailwind `hover:` classes
- **AVOID** hardcoded colors in SVG icons
- **AVOID** FontAwesome classes (`fa-*`) in new includes - use inline SVG

## COMPLETED REFACTORING (commit 609db48)

### 1. page_sidebar/* CSS Variable Migration ✓

**media_widgets.html and references.html** now use Tailwind classes directly:
```html
<!-- Before (legacy) -->
<h3 style="color: var(--text-secondary)">...</h3>
<div style="background: var(--bg-secondary); border: 1px solid var(--border-primary)">

<!-- After (Tailwind) -->
<h3 class="text-foreground">...</h3>
<div class="bg-surface border border-border">
```

### 2. Inline Style Removal (sidebar.html) ✓

**Now uses pure Tailwind classes:**
```html
<a href="..." class="block py-2 px-3 text-sm border-l-2 transition-all 
   {% if active %}
     text-accent border-accent bg-accent/10
   {% else %}
     text-foreground/75 border-transparent hover:text-foreground hover:border-border hover:bg-surface
   {% endif %}">
```

### 3. TOC Component Consolidation ✓

**`page_sidebar/toc.html` DELETED** - Use `<sidebar-toc>` web component everywhere.

## DATA DEPENDENCIES

| Include | Requires Data From |
|---------|-------------------|
| `header.html` | `site.data.navigation.primary`, `site.github_url` |
| `sidebar.html` | `site.notes` collection |
| `notes_graph.json` | Auto-generated by `bidirectional_links_generator.rb` |
| `page_sidebar/media_widgets.html` | `page.audio_file`, `page.audio_timestamps`, `page.videos` |
| `page_sidebar/references.html` | `page.sources` |

## DELETED INCLUDES (commit 609db48)

| Include | Reason | Replacement |
|---------|--------|-------------|
| `page_sidebar/toc.html` | Duplicate functionality | Use `<sidebar-toc>` web component |

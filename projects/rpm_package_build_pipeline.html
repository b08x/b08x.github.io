<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPM Package Build Pipeline Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- https://g.co/gemini/share/2da0fec5c133 -->
    <!-- Application Structure Plan: The application is structured as a vertical, single-page guide that walks the user through the phases of setting up an RPM build pipeline. This linear flow—from local setup with Mock, to building, to repository management, and finally to cloud integration with COPR—is the most intuitive way to present a procedural plan. The structure uses interactive checklists and command builders to make abstract steps tangible and engaging. This design was chosen over a dashboard because the content is a learning path, not a set of simultaneous data points. The goal is to guide the user from basic to advanced concepts in a logical sequence. -->
    <!-- Visualization & Content Choices: Report Info: Mock setup steps -> Goal: Guide user -> Viz/Presentation: Interactive Checklist -> Interaction: User can check items, which visually strikes them through -> Justification: Provides a sense of completion and progress, more engaging than a static list -> Library/Method: HTML/JS. | Report Info: Mock build command -> Goal: Educate on command structure -> Viz/Presentation: Dynamic code block with toggles -> Interaction: Toggling options updates the command string in real-time -> Justification: Teaches the command's flexibility without overwhelming the user -> Library/Method: HTML/JS. | Report Info: Local Repo vs. COPR -> Goal: Compare options -> Viz/Presentation: Two-column comparison table -> Interaction: Simple hover effects for clarity -> Justification: Allows for quick, direct comparison of features to aid decision-making -> Library/Method: HTML/Tailwind. | Report Info: Overall process -> Goal: Show relationships -> Viz/Presentation: Flowchart diagram -> Interaction: Clicking a stage scrolls to the relevant section -> Justification: Provides a high-level overview and connects all the individual steps into a cohesive workflow -> Library/Method: HTML/Tailwind. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa;
            color: #343a40;
        }
        .step-card {
            background-color: white;
            border-radius: 0.75rem;
            border: 1px solid #e9ecef;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: all 0.3s ease-in-out;
        }
        .step-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .checklist-item {
            cursor: pointer;
            transition: all 0.2s;
        }
        .checklist-item.completed {
            text-decoration: line-through;
            color: #6c757d;
        }
        .checklist-item.completed .checkbox-icon {
            background-color: #0d6efd;
            border-color: #0d6efd;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='white'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
        }
        .checkbox-icon {
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid #adb5bd;
            border-radius: 0.25rem;
            flex-shrink: 0;
            transition: all 0.2s;
        }
        .flowchart-box {
            border: 2px solid #0d6efd;
            background-color: #e7f1ff;
            color: #052c65;
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            font-weight: 500;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .flowchart-arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: #0d6efd;
            font-weight: bold;
        }
        @media (max-width: 768px) {
            .flowchart-arrow {
                transform: rotate(90deg);
                margin: 0.5rem 0;
            }
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto p-4 md:p-8 max-w-5xl">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800">RPM Package Build Pipeline</h1>
            <p class="mt-4 text-lg text-gray-600">An interactive guide to setting up a robust RPM build system using Mock, local repositories, and Fedora COPR.</p>
        </header>

        <main class="space-y-16">
            <!-- Phase 1: Local Build Environment -->
            <section id="mock-setup" class="step-card p-6 md:p-8">
                <div class="flex items-center mb-4">
                    <span class="bg-blue-600 text-white text-xl font-bold rounded-full w-10 h-10 flex items-center justify-center mr-4">1</span>
                    <h2 class="text-3xl font-bold text-gray-800">Phase 1: Local Build with Mock</h2>
                </div>
                <p class="text-gray-600 mb-6">Mock is the standard tool for building RPMs in a clean, isolated chroot environment. This ensures your package build is reproducible and doesn't depend on your host system's configuration.</p>
                <h3 class="text-xl font-semibold mb-4 text-gray-700">Setup Checklist</h3>
                <div id="mock-checklist" class="space-y-3">
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Install Mock: <code class="bg-gray-200 text-sm p-1 rounded">sudo dnf install mock</code></span>
                    </div>
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Add your user to the 'mock' group: <code class="bg-gray-200 text-sm p-1 rounded">sudo usermod -a -G mock $(whoami)</code></span>
                    </div>
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Apply group changes (log out and log back in, or use <code class="bg-gray-200 text-sm p-1 rounded">newgrp mock</code> in your shell).</span>
                    </div>
                     <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Update mock configurations: <code class="bg-gray-200 text-sm p-1 rounded">sudo mock -r fedora-rawhide-x86_64 --init</code></span>
                    </div>
                </div>
            </section>

            <!-- Phase 2: Building the RPM -->
            <section id="build-rpm" class="step-card p-6 md:p-8">
                 <div class="flex items-center mb-4">
                    <span class="bg-blue-600 text-white text-xl font-bold rounded-full w-10 h-10 flex items-center justify-center mr-4">2</span>
                    <h2 class="text-3xl font-bold text-gray-800">Phase 2: Building an RPM</h2>
                </div>
                <p class="text-gray-600 mb-6">Once Mock is set up, you can build a Source RPM (`.src.rpm`). The command is highly configurable. Use the options below to see how the command changes.</p>
                
                <div class="bg-white rounded-lg border border-gray-200 p-4">
                    <h3 class="text-xl font-semibold mb-4 text-gray-700">Interactive Mock Command Builder</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <label class="flex items-center space-x-3 p-2 rounded-md bg-gray-100">
                            <input type="checkbox" id="rebuild-opt" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                            <span>Use <code class="text-sm">--rebuild</code> (for SRPMs)</span>
                        </label>
                        <label class="flex items-center space-x-3 p-2 rounded-md bg-gray-100">
                            <input type="checkbox" id="resultdir-opt" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                            <span>Specify result directory</span>
                        </label>
                         <label class="flex items-center space-x-3 p-2 rounded-md bg-gray-100">
                            <input type="checkbox" id="enablerepo-opt" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                            <span>Enable an extra repository</span>
                        </label>
                         <label class="flex items-center space-x-3 p-2 rounded-md bg-gray-100">
                            <input type="checkbox" id="no-clean-opt" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                            <span>Keep chroot after build</span>
                        </label>
                    </div>
                    <pre class="bg-gray-800 text-white p-4 rounded-md text-sm whitespace-pre-wrap"><code id="mock-command"></code></pre>
                </div>
            </section>

            <!-- Phase 3: Local Repository -->
            <section id="local-repo" class="step-card p-6 md:p-8">
                 <div class="flex items-center mb-4">
                    <span class="bg-blue-600 text-white text-xl font-bold rounded-full w-10 h-10 flex items-center justify-center mr-4">3</span>
                    <h2 class="text-3xl font-bold text-gray-800">Phase 3: Local RPM Repository</h2>
                </div>
                <p class="text-gray-600 mb-6">After building your RPMs, you need a way to distribute them. A local repository is a simple way to host your packages for testing on your local network.</p>
                <h3 class="text-xl font-semibold mb-4 text-gray-700">Repository Setup Checklist</h3>
                <div id="repo-checklist" class="space-y-3">
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Install repository creation tool: <code class="bg-gray-200 text-sm p-1 rounded">sudo dnf install createrepo_c</code></span>
                    </div>
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Create a directory to host RPMs: <code class="bg-gray-200 text-sm p-1 rounded">mkdir -p /path/to/my/repo</code></span>
                    </div>
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Copy your newly built RPMs into this directory.</span>
                    </div>
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Generate repository metadata: <code class="bg-gray-200 text-sm p-1 rounded">createrepo_c /path/to/my/repo</code></span>
                    </div>
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Serve the directory over HTTP (e.g., using <code class="bg-gray-200 text-sm p-1 rounded">python3 -m http.server</code> or Nginx).</span>
                    </div>
                </div>
            </section>

            <!-- Phase 4: Fedora COPR -->
            <section id="copr-integration" class="step-card p-6 md:p-8">
                 <div class="flex items-center mb-4">
                    <span class="bg-blue-600 text-white text-xl font-bold rounded-full w-10 h-10 flex items-center justify-center mr-4">4</span>
                    <h2 class="text-3xl font-bold text-gray-800">Phase 4: Integrate with Fedora COPR</h2>
                </div>
                <p class="text-gray-600 mb-6">Fedora's COPR (Cool Other Package Repo) is a public build service that automates building and hosting RPMs. It's an excellent alternative to managing your own repository, especially for public projects.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <h3 class="text-xl font-semibold text-center text-green-700 mb-3">Local Repository</h3>
                        <ul class="space-y-2 list-disc list-inside text-gray-700">
                            <li><strong>Fast:</strong> Builds and tests are on your local machine.</li>
                            <li><strong>Private:</strong> Ideal for internal or proprietary software.</li>
                            <li><strong>Full Control:</strong> You manage the entire environment.</li>
                            <li><strong>Manual:</strong> Requires manual steps for building and publishing.</li>
                        </ul>
                    </div>
                     <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <h3 class="text-xl font-semibold text-center text-blue-700 mb-3">Fedora COPR</h3>
                        <ul class="space-y-2 list-disc list-inside text-gray-700">
                            <li><strong>Automated:</strong> Integrates with SCM (like Git) for automatic builds.</li>
                            <li><strong>Public:</strong> Easy for others to discover and use your packages.</li>
                            <li><strong>Multi-Arch:</strong> Builds for multiple architectures automatically.</li>
                            <li><strong>Managed:</strong> No need to manage build servers or repositories.</li>
                        </ul>
                    </div>
                </div>

                <h3 class="text-xl font-semibold mt-8 mb-4 text-gray-700">COPR Setup Checklist</h3>
                 <div id="copr-checklist" class="space-y-3">
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Create an account on the <a href="https://copr.fedorainfracloud.org/" target="_blank" class="text-blue-600 hover:underline">Fedora COPR website</a>.</span>
                    </div>
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Install the command-line client: <code class="bg-gray-200 text-sm p-1 rounded">sudo dnf install copr-cli</code></span>
                    </div>
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Authenticate your client by following the website's API instructions.</span>
                    </div>
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Create a new project: <code class="bg-gray-200 text-sm p-1 rounded">copr-cli create my-project-name --chroot fedora-rawhide-x86_64</code></span>
                    </div>
                    <div class="checklist-item flex items-center p-3 bg-gray-50 rounded-lg">
                        <div class="checkbox-icon mr-4"></div>
                        <span>Build your SRPM: <code class="bg-gray-200 text-sm p-1 rounded">copr-cli build my-project-name /path/to/package.src.rpm</code></span>
                    </div>
                </div>
            </section>
            
            <!-- Summary Workflow -->
            <section id="summary" class="mt-16">
                 <h2 class="text-3xl font-bold text-center mb-8 text-gray-800">Complete Workflow Overview</h2>
                 <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-center">
                    <div class="flowchart-box">Source Code / SRPM</div>
                    <div class="flowchart-arrow">&#10230;</div>
                    <div class="flowchart-box">Mock Build Environment</div>
                    <div class="flowchart-arrow">&#10230;</div>
                    <div class="relative col-span-1 md:col-start-5">
                         <div class="flowchart-box">Published RPMs</div>
                         <div class="absolute top-1/2 -left-12 md:-left-16 text-2xl font-bold text-blue-600 -translate-y-1/2">
                            <div class="md:hidden"> &#11167; </div> <!-- down arrow for mobile -->
                         </div>
                    </div>
                 </div>
                 <div class="grid md:grid-cols-5 gap-4 mt-4 items-center">
                     <div class="col-span-1 md:col-start-3 text-center">
                        <div class="flowchart-arrow transform -rotate-90 md:rotate-0">&#10550;</div>
                     </div>
                 </div>
                 <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-center">
                    <div class="md:col-start-2 flowchart-box bg-green-100 border-green-600 text-green-800">Local Repository</div>
                    <div class="flowchart-arrow">&#10230;</div>
                    <div class="md:col-start-4 flowchart-box bg-indigo-100 border-indigo-600 text-indigo-800">Fedora COPR</div>
                 </div>
            </section>
        </main>

        <footer class="text-center mt-16 pt-8 border-t border-gray-200">
            <p class="text-gray-500">Interactive guide designed for modern package development.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mockCommandEl = document.getElementById('mock-command');
            const rebuildOpt = document.getElementById('rebuild-opt');
            const resultdirOpt = document.getElementById('resultdir-opt');
            const enablerepoOpt = document.getElementById('enablerepo-opt');
            const noCleanOpt = document.getElementById('no-clean-opt');
            
            function updateMockCommand() {
                let command = 'mock -r fedora-rawhide-x86_64 ';

                if (resultdirOpt.checked) {
                    command += '--resultdir=./results ';
                }
                
                if (enablerepoOpt.checked) {
                    command += '--enablerepo=my-extra-repo ';
                }

                if (noCleanOpt.checked) {
                    command += '--no-clean ';
                }

                if (rebuildOpt.checked) {
                    command += '--rebuild /path/to/package.src.rpm';
                } else {
                    command += '/path/to/package.spec';
                }

                mockCommandEl.textContent = command;
            }

            [rebuildOpt, resultdirOpt, enablerepoOpt, noCleanOpt].forEach(opt => {
                opt.addEventListener('change', updateMockCommand);
            });

            updateMockCommand();

            function setupChecklist(containerId) {
                const container = document.getElementById(containerId);
                if (container) {
                    container.addEventListener('click', (event) => {
                        const item = event.target.closest('.checklist-item');
                        if (item) {
                            item.classList.toggle('completed');
                        }
                    });
                }
            }

            setupChecklist('mock-checklist');
            setupChecklist('repo-checklist');
            setupChecklist('copr-checklist');
        });
    </script>
</body>
</html>
